(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{1264:function(t,e,n){"use strict";n.r(e);var o=n(421),r=n(405),l=n.n(r),c={name:"BlogCover",head:function(){return this.$store.state.currentTool.head},components:{"compact-picker":o.Compact},data:function(){return{bgUrl:"",n:null,loading:!1,index:0,labels:[{label:"上传图"},{label:"请输入网络图片URL"}],width:"960",height:"320",fontSize:"font-size:4em;",text:"神奇工具箱的专栏分享",secondText:"by 一灰灰",secondFontSize:"font-size:2em;font-style: italic;font-family: cursive;",bgColor:"#16A5A5FF",bgColorInput:"#16A5A5FF",textColor:"#eeeeee",textColorInput:"#eeeeee",secondTextColor:"#eeeeee",secondTextColorInput:"#eeeeee",imgUrl:""}},watch:{bgColor:function(){this.bgColorInput=this.bgColor.hex8},textColor:function(){this.textColorInput=this.textColor.hex8},secondTextColor:function(){this.secondTextColorInput=this.secondTextColor.hex8}},computed:{show:function(){var t=this.bgColorInput.trim(),e=this.textColorInput.trim(),n=this.secondTextColorInput.trim();return this.bgUrl&&(t="url("+this.bgUrl+")"),'<div style="background: '.concat(t,"; width:").concat(this.width,"px; height: ").concat(this.height,'px;" class="nav flex-column justify-content-center text-center">\n                        <span style="').concat(this.fontSize,"; color: ").concat(e,'">').concat(this.text,'</span>\n                        <span style="').concat(this.secondFontSize,"; color: ").concat(n,'">').concat(this.secondText,"</span>\n                    </div>")}},methods:{handleChange:function(t){var e=t.target.files;if(!e.length)return!1;this.file=e[0],this.docs=[],this.bgUrl=URL.createObjectURL(this.file)},save:function(){var t=this;l.a.toBlob(this.$refs.preview).then((function(e){console.log("e:",e,URL.createObjectURL(e)),t.imgUrl=URL.createObjectURL(e)})).catch((function(e){t.$modal.show("dialog",{title:"生成失败",text:"ERROR: ".concat(e)})}))}}},f=n(2),component=Object(f.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-cover"},[e("nya-container",{attrs:{title:"专栏封面"}},[e("div",{staticClass:"nya-subtitle mt-15"},[t._v("\n                背景图选择\n            ")]),t._v(" "),e("div",{staticClass:"radio-group"},[e("nya-radio-group",{model:{value:t.index,callback:function(e){t.index=e},expression:"index"}},t._l(t.labels,(function(label,i){return e("nya-radio",{key:i,staticClass:"mr-15",attrs:{value:i,label:label.label}})})),1)],1),t._v(" "),e("div",{staticClass:"inputbtn"},[0===t.index?e("nya-input",{staticClass:"upfile",attrs:{type:"file",accept:"image/*",placeholder:"点击这里上传文件"},on:{change:t.handleChange},model:{value:t.n,callback:function(e){t.n=e},expression:"n"}}):e("nya-input",{attrs:{type:"text",placeholder:"输入图片url"},model:{value:t.bgUrl,callback:function(e){t.bgUrl=e},expression:"bgUrl"}}),t._v(" "),e("button",{staticClass:"nya-btn",attrs:{type:"button",disabled:t.loading},on:{click:t.save}},[t._v("\n                    "+t._s(t.loading?"生成中":"生成")+"\n                ")])],1),t._v(" "),e("div",{staticClass:"form-inline top-padding-2em"},[e("span",{staticClass:"text-center",staticStyle:{"margin-right":"1em"}},[t._v(" 封面大小")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.width,expression:"width"}],staticClass:"form-control",attrs:{type:"text",placeholder:"960"},domProps:{value:t.width},on:{input:function(e){e.target.composing||(t.width=e.target.value)}}}),t._v(" "),e("span",{staticClass:"text-center no-border",staticStyle:{"margin-left":"1em","margin-right":"1em"}},[t._v(" X ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.height,expression:"height"}],staticClass:"form-control",attrs:{type:"text",placeholder:"320"},domProps:{value:t.height},on:{input:function(e){e.target.composing||(t.height=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-inline top-padding-1em"},[e("span",{staticClass:"text-center",staticStyle:{"margin-right":"1em"}},[t._v("主标题")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control text-center col-6",attrs:{type:"text"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}}),t._v(" "),e("span",{staticClass:"text-center",staticStyle:{"margin-right":"1em","margin-left":"1em"}},[t._v("字体样式")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fontSize,expression:"fontSize"}],staticClass:"form-control text-center col-4",attrs:{type:"text"},domProps:{value:t.fontSize},on:{input:function(e){e.target.composing||(t.fontSize=e.target.value)}}}),t._v(" "),e("client-only",[e("div",{staticClass:"form-inline top-padding-1em"},[e("span",{staticClass:"text-center"},[t._v(" 颜色 ")]),t._v(" "),e("compact-picker",{staticClass:"form-control",staticStyle:{"margin-left":"1em"},model:{value:t.textColor,callback:function(e){t.textColor=e},expression:"textColor"}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.textColorInput,expression:"textColorInput"}],staticClass:"text-center",staticStyle:{"margin-left":"1em"},attrs:{type:"text",placeholder:"自定义#666666"},domProps:{value:t.textColorInput},on:{input:function(e){e.target.composing||(t.textColorInput=e.target.value)}}})],1)])],1),t._v(" "),e("div",{staticClass:"form-inline top-padding-1em"},[e("span",{staticClass:"text-center",staticStyle:{"margin-right":"1em"}},[t._v("副标题")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.secondText,expression:"secondText"}],staticClass:"form-control text-center col-6",attrs:{type:"text"},domProps:{value:t.secondText},on:{input:function(e){e.target.composing||(t.secondText=e.target.value)}}}),t._v(" "),e("span",{staticClass:"text-center",staticStyle:{"margin-right":"1em","margin-left":"1em"}},[t._v("字体样式")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.secondFontSize,expression:"secondFontSize"}],staticClass:"form-control text-center col-4",attrs:{type:"text"},domProps:{value:t.secondFontSize},on:{input:function(e){e.target.composing||(t.secondFontSize=e.target.value)}}}),t._v(" "),e("client-only",[e("div",{staticClass:"form-inline top-padding-1em"},[e("span",{staticClass:"text-center"},[t._v(" 颜色 ")]),t._v(" "),e("compact-picker",{staticClass:"form-control",staticStyle:{"margin-left":"1em"},model:{value:t.secondTextColor,callback:function(e){t.secondTextColor=e},expression:"secondTextColor"}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.secondTextColorInput,expression:"secondTextColorInput"}],staticClass:"text-center",staticStyle:{"margin-left":"1em"},attrs:{type:"text",placeholder:"自定义#666666"},domProps:{value:t.secondTextColorInput},on:{input:function(e){e.target.composing||(t.secondTextColorInput=e.target.value)}}})],1)])],1),t._v(" "),e("client-only",[e("div",{staticClass:"form-inline top-padding-1em"},[e("span",{staticClass:"text-center"},[t._v(" 背景颜色 ")]),t._v(" "),e("compact-picker",{staticClass:"form-control",staticStyle:{"margin-left":"1em"},model:{value:t.bgColor,callback:function(e){t.bgColor=e},expression:"bgColor"}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.bgColorInput,expression:"bgColorInput"}],staticClass:"text-center",staticStyle:{"margin-left":"1em"},attrs:{type:"text",placeholder:"自定义#cccccc"},domProps:{value:t.bgColorInput},on:{input:function(e){e.target.composing||(t.bgColorInput=e.target.value)}}})],1)]),t._v(" "),e("div",{staticClass:"nya-subtitle top-margin-1em"},[e("p",[t._v("实时预览：")]),t._v(" "),e("div",{ref:"preview",style:"width:"+t.width+"px;height:"+t.height+"px;",attrs:{id:"preview"},domProps:{innerHTML:t._s(t.show)}})])],1),t._v(" "),e("nya-container",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl,expression:"imgUrl"}],staticClass:"preview",attrs:{title:"生成成功"}},[e("a",{attrs:{href:t.imgUrl,target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:t.imgUrl,alt:"image"}})])]),t._v(" "),e("nya-foot-info",{attrs:{title:"Tips"}},[e("li",[t._v("预览区图片无法直接使用，请点击生成按钮获取图片")]),t._v(" "),e("li",[t._v("请不要直接引用图片http地址，如有需要右键保存")])])],1)}),[],!1,null,null,null);e.default=component.exports},405:function(t,e,n){!function(e){"use strict";var n=function(){return{escape:function(t){return t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:e,mimeType:function(t){var n=e(t).toLowerCase();return(o="application/font-woff",r="image/jpeg",{woff:o,woff2:o,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:r,jpeg:r,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[n]||"";var o,r},dataAsUrl:function(content,t){return"data:"+t+";base64,"+content},isDataUrl:function(t){return-1!==t.search(/^(data:)/)},canvasToBlob:function(canvas){return canvas.toBlob?new Promise((function(t){canvas.toBlob(t)})):function(canvas){return new Promise((function(t){for(var e=window.atob(canvas.toDataURL().split(",")[1]),n=e.length,o=new Uint8Array(n),i=0;i<n;i++)o[i]=e.charCodeAt(i);t(new Blob([o],{type:"image/png"}))}))}(canvas)},resolveUrl:function(t,e){var n=document.implementation.createHTMLDocument(),base=n.createElement("base");n.head.appendChild(base);var a=n.createElement("a");return n.body.appendChild(a),base.href=e,a.href=t,a.href},getAndEncode:function(t){var e=3e4;f.impl.options.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+(new Date).getTime());return new Promise((function(n){var o,r=new XMLHttpRequest;if(r.onreadystatechange=c,r.ontimeout=m,r.responseType="blob",r.timeout=e,r.open("GET",t,!0),r.send(),f.impl.options.imagePlaceholder){var l=f.impl.options.imagePlaceholder.split(/,/);l&&l[1]&&(o=l[1])}function c(){if(4===r.readyState)if(200===r.status){var e=new FileReader;e.onloadend=function(){var content=e.result.split(/,/)[1];n(content)},e.readAsDataURL(r.response)}else o?n(o):d("cannot fetch resource: "+t+", status: "+r.status)}function m(){o?n(o):d("timeout of "+e+"ms occured while fetching resource: "+t)}function d(t){console.error(t),n("")}}))},uid:(t=0,function(){return"u"+e()+t++;function e(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}),delay:function(t){return function(e){return new Promise((function(n){setTimeout((function(){n(e)}),t)}))}},asArray:function(t){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e},escapeXhtml:function(t){return t.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(t){return new Promise((function(e,n){var image=new Image;image.onload=function(){e(image)},image.onerror=n,image.src=t}))},width:function(t){var e=n(t,"border-left-width"),o=n(t,"border-right-width");return t.scrollWidth+e+o},height:function(t){var e=n(t,"border-top-width"),o=n(t,"border-bottom-width");return t.scrollHeight+e+o}};var t;function e(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""}function n(t,e){var n=window.getComputedStyle(t).getPropertyValue(e);return parseFloat(n.replace("px",""))}}(),o=function(){var t=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(t,n,l){return c()?Promise.resolve(t):Promise.resolve(t).then(o).then((function(e){var o=Promise.resolve(t);return e.forEach((function(t){o=o.then((function(e){return r(e,t,n,l)}))})),o}));function c(){return!e(t)}},shouldProcess:e,impl:{readUrls:o,inline:r}};function e(e){return-1!==e.search(t)}function o(e){for(var o,r=[];null!==(o=t.exec(e));)r.push(o[1]);return r.filter((function(t){return!n.isDataUrl(t)}))}function r(t,e,o,r){return Promise.resolve(e).then((function(t){return o?n.resolveUrl(t,o):t})).then(r||n.getAndEncode).then((function(data){return n.dataAsUrl(data,n.mimeType(e))})).then((function(o){return t.replace(function(t){return new RegExp("(url\\(['\"]?)("+n.escape(t)+")(['\"]?\\))","g")}(e),"$1"+o+"$3")}))}}(),r=function(){return{resolveAll:function(){return t(document).then((function(t){return Promise.all(t.map((function(t){return t.resolve()})))})).then((function(t){return t.join("\n")}))},impl:{readAll:t}};function t(){return Promise.resolve(n.asArray(document.styleSheets)).then((function(t){var e=[];return t.forEach((function(t){try{n.asArray(t.cssRules||[]).forEach(e.push.bind(e))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}})),e})).then((function(t){return t.filter((function(t){return t.type===CSSRule.FONT_FACE_RULE})).filter((function(t){return o.shouldProcess(t.style.getPropertyValue("src"))}))})).then((function(e){return e.map(t)}));function t(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return o.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}}}(),l=function(){return{inlineAll:function e(r){return r instanceof Element?l(r).then((function(){return r instanceof HTMLImageElement?t(r).inline():Promise.all(n.asArray(r.childNodes).map((function(t){return e(t)})))})):Promise.resolve(r);function l(t){var e=t.style.getPropertyValue("background");return e?o.inlineAll(e).then((function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))})).then((function(){return t})):Promise.resolve(t)}},impl:{newImage:t}};function t(element){return{inline:function(t){return n.isDataUrl(element.src)?Promise.resolve():Promise.resolve(element.src).then(t||n.getAndEncode).then((function(data){return n.dataAsUrl(data,n.mimeType(element.src))})).then((function(t){return new Promise((function(e,n){element.onload=e,element.onerror=n,element.src=t}))}))}}}}(),c={imagePlaceholder:void 0,cacheBust:!1},f={toSvg:m,toPng:function(t,e){return d(t,e||{}).then((function(canvas){return canvas.toDataURL()}))},toJpeg:function(t,e){return d(t,e=e||{}).then((function(canvas){return canvas.toDataURL("image/jpeg",e.quality||1)}))},toBlob:function(t,e){return d(t,e||{}).then(n.canvasToBlob)},toPixelData:function(t,e){return d(t,e||{}).then((function(canvas){return canvas.getContext("2d").getImageData(0,0,n.width(t),n.height(t)).data}))},impl:{fontFaces:r,images:l,util:n,inliner:o,options:{}}};function m(t,e){return function(t){void 0===t.imagePlaceholder?f.impl.options.imagePlaceholder=c.imagePlaceholder:f.impl.options.imagePlaceholder=t.imagePlaceholder;void 0===t.cacheBust?f.impl.options.cacheBust=c.cacheBust:f.impl.options.cacheBust=t.cacheBust}(e=e||{}),Promise.resolve(t).then((function(t){return h(t,e.filter,!0)})).then(v).then(x).then((function(t){e.bgcolor&&(t.style.backgroundColor=e.bgcolor);e.width&&(t.style.width=e.width+"px");e.height&&(t.style.height=e.height+"px");e.style&&Object.keys(e.style).forEach((function(n){t.style[n]=e.style[n]}));return t})).then((function(o){return function(t,e,o){return Promise.resolve(t).then((function(t){return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(t)})).then(n.escapeXhtml).then((function(t){return'<foreignObject x="0" y="0" width="100%" height="100%">'+t+"</foreignObject>"})).then((function(foreignObject){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+o+'">'+foreignObject+"</svg>"})).then((function(svg){return"data:image/svg+xml;charset=utf-8,"+svg}))}(o,e.width||n.width(t),e.height||n.height(t))}))}function d(t,e){return m(t,e).then(n.makeImage).then(n.delay(100)).then((function(image){var canvas=function(t){var canvas=document.createElement("canvas");if(canvas.width=e.width||n.width(t),canvas.height=e.height||n.height(t),e.bgcolor){var o=canvas.getContext("2d");o.fillStyle=e.bgcolor,o.fillRect(0,0,canvas.width,canvas.height)}return canvas}(t);return canvas.getContext("2d").drawImage(image,0,0),canvas}))}function h(t,filter,e){return e||!filter||filter(t)?Promise.resolve(t).then((function(t){return t instanceof HTMLCanvasElement?n.makeImage(t.toDataURL()):t.cloneNode(!1)})).then((function(e){return function(t,e,filter){var o=t.childNodes;return 0===o.length?Promise.resolve(e):r(e,n.asArray(o),filter).then((function(){return e}));function r(t,e,filter){var n=Promise.resolve();return e.forEach((function(e){n=n.then((function(){return h(e,filter)})).then((function(e){e&&t.appendChild(e)}))})),n}}(t,e,filter)})).then((function(e){return function(t,e){return e instanceof Element?Promise.resolve().then(o).then(r).then(l).then(c).then((function(){return e})):e;function o(){function o(source,t){function e(source,t){n.asArray(source).forEach((function(e){t.setProperty(e,source.getPropertyValue(e),source.getPropertyPriority(e))}))}source.cssText?t.cssText=source.cssText:e(source,t)}o(window.getComputedStyle(t),e.style)}function r(){function o(element){var style=window.getComputedStyle(t,element),content=style.getPropertyValue("content");if(""!==content&&"none"!==content){var o=n.uid();e.className=e.className+" "+o;var r=document.createElement("style");r.appendChild(l(o,element,style)),e.appendChild(r)}function l(t,element,style){var e="."+t+":"+element,o=style.cssText?r(style):l(style);return document.createTextNode(e+"{"+o+"}");function r(style){var content=style.getPropertyValue("content");return style.cssText+" content: "+content+";"}function l(style){return n.asArray(style).map(t).join("; ")+";";function t(t){return t+": "+style.getPropertyValue(t)+(style.getPropertyPriority(t)?" !important":"")}}}}[":before",":after"].forEach((function(element){o(element)}))}function l(){t instanceof HTMLTextAreaElement&&(e.innerHTML=t.value),t instanceof HTMLInputElement&&e.setAttribute("value",t.value)}function c(){e instanceof SVGElement&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e instanceof SVGRectElement&&["width","height"].forEach((function(t){var n=e.getAttribute(t);n&&e.style.setProperty(t,n)})))}}(t,e)})):Promise.resolve()}function v(t){return r.resolveAll().then((function(e){var n=document.createElement("style");return t.appendChild(n),n.appendChild(document.createTextNode(e)),t}))}function x(t){return l.inlineAll(t).then((function(){return t}))}t.exports=f}()}}]);